<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <title>C64 PRG Loader</title>
  <script src="./js/vc64web_player.js"></script>
  <style>
    body { background: #111; color: #fff; font-family: sans-serif; text-align: center; }
    #p { width: 80%; height: 600px; background: #000; border: 4px solid #666; margin: 0 auto; }
  </style>
</head>
<body>
  <div id="p"></div>
  <script>
    const config = {
      navbar: true, wide: true, port2: true,
      dialog_on_missing_roms: false, // Usa le ROM interne se può
      
      // Carichiamo il PRG come se fosse un file nella cartella corrente
      samesite_file: { url: "gioco.prg", name: "gioco.prg" },

      buttons: [{
        run: true,
        // Script ultra-veloce per PRG
        script: `(async function() {
           const w = (ms) => new Promise(r => setTimeout(r, ms));
           await wasm_ready_after_reset();
           await w(500); // Mezzo secondo di attesa
           
           // LOAD "gioco.prg" e RUN automatico
           // Il trucco: action('=>LoadPrg') è un comando speciale di questo emulatore
           // Se non va, usiamo il metodo classico:
           
           const type = async(t) => { for(let c of t) { await action(c); await w(20); } };
           
           await type('LOAD'); 
           await action('=>Enter');
           await w(500); // Aspetta che finisca il "SEARCHING FOR..."
           await type('RUN'); 
           await action('=>Enter');
        })()`
      }]
    };
    vc64web_player.load(document.getElementById("p"), encodeURIComponent(JSON.stringify(config)));
  </script>
</body>
</html>
